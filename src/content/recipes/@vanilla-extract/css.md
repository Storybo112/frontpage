<div class="aside aside__no-top">

This recipe assumes that you are using Storybook >= 7.0. If you haven't set up Storybook yet, run the following command in the root of your project:

```shell
npx storybook@latest init
```

</div>

<RecipeHeader>

How to setup Vanilla Extract and Storybook

</RecipeHeader>

Vanilla Extract Uses TypeScript as your CSS preprocessor. Allowing you to write typeâ€‘safe, locally scoped classes, variables and themes, then generate static CSS files at build time. Storybook is an industry-standard tool for developing and testing UI components in isolation.

## Configure your Storybook builder

<div class="aside aside__no-top">

If you're already using Vanilla Extract in your project, you may already have these dependencies installed.

</div>

First of all, install the required dependencies:

```shell
# For Vite users
yarn add -D @vanilla-extract/vite-plugin

# For Webpack users
yarn add -D @vanilla-extract/webpack-plugin mini-css-extract-plugin
```

### Vite

For Vite users, Storybook uses your project's `vite.config.js` for it's build configuration. This means, if your project is using Vanilla Extract, it's already configured for your Storybook as well. ðŸŽ‰

You can view a full example on [Stackblitz](https://stackblitz.com/edit/github-cytqag?file=.storybook/main.ts).

### Webpack

For Webpack users, add a `webpackFinal` function to your `main.ts` file like so:

```ts
// Replace with your framework
import type { StorybookConfig } from '@storybook/react-webpack5';

import { VanillaExtractPlugin } from '@vanilla-extract/webpack-plugin';
import MiniCssExtractPlugin from 'mini-css-extract-plugin';

const config: StorybookConfig = {
  stories: ['../src/**/*.mdx', '../src/**/*.stories.@(js|jsx|ts|tsx)'],
  addons: [
    '@storybook/addon-links',
    '@storybook/addon-essentials',
    '@storybook/addon-interactions',
  ],
  framework: {
    // Replace with your framework
    name: '@storybook/react-webpack5',
    options: {},
  },
  docs: {
    autodocs: 'tag',
  },
  webpackFinal(config, options) {
    // Add Vanilla-Extract and MiniCssExtract Plugins
    config.plugins?.push(new VanillaExtractPlugin(), new MiniCssExtractPlugin());

    // Exclude vanilla extract's "*.vanilla.css" files from other "*.css" processing
    config.module?.rules?.forEach((rule) => {
      if (typeof rule !== 'string' && rule.test instanceof RegExp && rule.test.test('test.css')) {
        rule.exclude = /\.vanilla\.css$/i;
      }
    });

    config.module?.rules?.push({
      // Targets only CSS files generated by vanilla-extract
      test: /\.vanilla\.css$/i,
      use: [
        MiniCssExtractPlugin.loader,
        {
          loader: require.resolve('css-loader'),
          options: {
            // Required as image imports should be handled via JS/TS import statements
            url: false,
          },
        },
      ],
    });

    return config;
  },
};

export default config;
```

You can view a full example on [Stackblitz](https://stackblitz.com/edit/sb-vanilla-extract-webpack?file=.storybook/main.ts).

## Get involved

Now you're ready to use Vanilla Extract with Storybook. ðŸŽ‰ If you use Vanilla Extract at work, we'd love your feedback on the Vanilla Extract + Storybook experience.

Join the maintainers and our thriving community in [Discord](https://discord.gg/storybook).
